Para lograr que Bahmni interactúe con OpenHIM y que este a su vez realice las operaciones de IPS LAC y QR con los servidores, podemos estructurar el flujo de la siguiente manera:

Flujo General: /// mansilla, revisa esto
Bahmni actuará como el punto de entrada donde los usuarios pueden visualizar y gestionar los datos de los pacientes y sus International Patient Summary (IPS).
OpenHIM será el intermediario que gestionará la validación de los datos, interacción con servidores de IPS LAC, generación y validación de QR, y finalmente, la gestión de los documentos IPS y VAC en servidores FHIR.
Servidores externos: OpenHIM interactuará con servidores externos para realizar las operaciones de IPS, QR y certificados digitales (DVC).
Pasos específicos:


En Bahmni:

Crear un custom display control que permita a los usuarios ver, subir y gestionar documentos IPS LAC. Este control debería enviar las solicitudes a OpenHIM.

Añadir un dashboard para los usuarios que centralice las opciones de interacción con IPS, incluidos los procesos de generación de QR y validación.

OpenHIM:

Implementar en mediador
TC8 - ITI-67 Find Document Reference: OpenHIM interactuará con servidores FHIR para buscar referencias de documentos IPS LAC y IPS VAC.
TC9 - ITI-68 Retrieve Document: OpenHIM recuperará los documentos IPS LAC y VAC del servidor FHIR.
TC10 - Use/Consume IPS LAC: OpenHIM permitirá que Bahmni use, vea o suba documentos IPS LAC de otros países.
TC11 - Generate VHL QR from IPS LAC: OpenHIM generará códigos QR para la inmunización del paciente basándose en el IPS.
TC12 - Retrieve VHL QR: OpenHIM permitirá recuperar un código QR generado para la inmunización del paciente.
TC13 y TC14 - Transform/Validate QR DVC y Use/Validate QR DVC: OpenHIM gestionará la transformación y validación de certificados de vacunación digital (DVC) utilizando la verificación de la OMS.
TC15 - Use/Consume QR DVC: OpenHIM permitirá la validación de los QR DVC de otros países.


-.-.-.- aqui la parte del Custom display Control
openmrsPatientService: Este servicio sigue gestionando la obtención de datos del paciente desde OpenMRS.

ipsSummaryControl: La lógica de este display control está completamente encapsulada, incluyendo todas las interacciones con OpenHIM para obtener y manejar los datos del IPS LAC y los QR.

ipsService: Este servicio se encarga de hacer las llamadas API a OpenHIM para:

Buscar documentos IPS LAC (ITI-67).
Recuperar un documento IPS (ITI-68).
Generar un QR basado en IPS (TC11).
Validar un QR (TC13/TC14).
spinner: Este objeto muestra una rueda de carga mientras las llamadas API a OpenHIM están en progreso.

Template: El HTML se carga desde un archivo separado llamado ips-summary.html, que muestra la interfaz de usuario.

--.-.-.- aqui la parte del Mediador de Openhim

Funciones específicas del mediador  /// mansilla, revisa esto
1. Buscar Documentos IPS (ITI-67)
Se consulta el servidor FHIR para buscar referencias de documentos del paciente.
Se recibe el patientId de Bahmni y se realizan las llamadas API al servidor FHIR.
2. Recuperar Documento IPS (ITI-68)
Se consulta el servidor FHIR para recuperar un documento específico utilizando el documentId.
3. Generar QR desde IPS (TC11)
A partir de los datos del IPS, se genera un código QR que puede ser utilizado para vacunaciones y otros fines.
4. Validar QR (TC13/TC14)
El QR generado es validado contra el servidor correspondiente, por ejemplo, usando Gazelle. ??? no tengo idea en verdad
